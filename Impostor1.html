<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Impostor Panel</title>
<style>
  body { background: black; color: red; font-family: monospace; display: flex; align-items: center; justify-content: center; height: 100vh; margin:0; padding:0; }
  .panel { background: #111; border: 2px solid red; padding: 30px; text-align: center; border-radius: 12px; max-width: 1100px; width: 90%; }
  .timer { text-align: center; margin-top: 20px; font-size: 16px; color: yellow; }
  .users-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 12px; margin-top: 12px; text-align: left; }
  .user-card { background: #0b0b0b; border: 1px solid rgb(104, 12, 12); padding: 10px; border-radius: 8px; font-size: 14px; }
  .username { font-weight: bold; margin-bottom: 6px; }
  .clue { background: rgba(255,255,255,0.03); border: 1px dashed rgb(117, 23, 23); padding: 8px; margin-bottom: 8px; }
  .input-row { display: flex; gap: 6px; margin-bottom: 6px; }
  .input-row input { flex:1; padding:6px; border-radius:6px; border:1px solid red; background:#111; color:rosybrown; }
  .status { font-size:13px; margin-top:4px; }
  .submit-btn { margin-top: 14px; padding: 12px 24px; font-size: 18px; background: red; color:black; border:none; border-radius:8px; cursor:pointer; font-weight:bold; transition:0.2s; }
  .submit-btn:hover { background: #bfff4d; }
  .nav-bar { width:100%; text-align:center; margin-bottom:12px; }
  .nav-bar button { padding: 10px 20px; font-size:16px; background: red; color:black; border:none; border-radius:6px; cursor:pointer; font-weight:bold; }
  .nav-bar button:hover { background:#bfff4d; }
  #iframeOverlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.95); z-index:999; }
  #iframeOverlay iframe { width:100%; height:100%; border:none; }
  #iframeOverlay button { position:absolute; top:10px; right:10px; background:red; color:white; font-size:16px; border:none; padding:8px 12px; cursor:pointer; border-radius:6px; }
</style>
</head>
<body>
<div class="panel">
  <div class="timer" id="timer">05:00</div>
  <div class="nav-bar">
    <button id="openSiteBtn">Open External Site</button>
  </div>
  <div class="users-grid" id="usersGrid"></div>
  <button id="submitBtn" class="submit-btn">Submit All</button>
</div>

<div id="iframeOverlay">
  <button id="closeIframe">Close</button>
  <iframe src=""></iframe>
</div>

<script>
  // --- Timer 5 min ---
  const timerEl=document.getElementById('timer');
  let timeLeft=5*60;
  setInterval(()=>{
    timeLeft--;
    const m=Math.floor(timeLeft/60), s=timeLeft%60;
    timerEl.textContent=`${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
  },1000);

  // --- External site iframe ---
  const iframeOverlay=document.getElementById('iframeOverlay');
  const iframe=iframeOverlay.querySelector('iframe');
  document.getElementById('openSiteBtn').onclick=()=>{
    iframe.src='s.html'; // change this to the site you want
    iframeOverlay.style.display='block';
  };
  document.getElementById('closeIframe').onclick=()=>{ iframeOverlay.style.display='none'; };

  // --- Puzzle setup ---
  const usersGrid=document.getElementById('usersGrid');
  const adjectives=["cyan","sly","quiet","vivid","crisp","neon"];
  const nouns=["fox","circuit","brush","byte","ember","gizmo"];
  const passwords=["alpha","orbit7","matrix","pulse","sunny","shadow","neon5","cipher"];
  const users=[];

  function makeUsername(){return adjectives[Math.floor(Math.random()*adjectives.length)]+"_"+nouns[Math.floor(Math.random()*nouns.length)];}
  function makeClue(pw){const types=["anagram","length","reverse"];const type=types[Math.floor(Math.random()*types.length)]; if(type==="anagram") return {text:`Anagram: ${pw.split('').sort(()=>Math.random()-0.5).join('')}`}; if(type==="length") return {text:`Length: ${pw.length} characters`}; if(type==="reverse") return {text:`Reverse: ${pw.split('').reverse().join('')}`};}

  for(let i=0;i<12;i++){
    const u=makeUsername();
    const pw=passwords[Math.floor(Math.random()*passwords.length)];
    const clue=makeClue(pw);
    users.push({u,pw,clue,solved:false});
  }

  function renderGrid(){
    usersGrid.innerHTML='';
    users.forEach((usr,i)=>{
      const card=document.createElement('div');
      card.className='user-card';
      card.innerHTML=`
        <div class="username">${usr.u}</div>
        <div class="clue">${usr.clue.text}</div>
        <div class="input-row">
          <input id="pw${i}" placeholder="password"/>
          <div class="status" id="st${i}">â€”</div>
        </div>
      `;
      usersGrid.appendChild(card);
    });
  }

  function checkAll(){
    let correctCount=0;
    users.forEach((usr,i)=>{
      const input=document.getElementById(`pw${i}`);
      const status=document.getElementById(`st${i}`);
      if(input.value.trim()===usr.pw){
        usr.solved=true;
        status.innerHTML='<span style="color:#8ff;font-weight:bold;">Correct</span>';
        correctCount++;
      }else{
        usr.solved=false;
        status.textContent='Incorrect';
      }
    });
    if(correctCount>=Math.ceil(users.length*0.7)){ // 70% threshold
      alert(`You got ${correctCount}/12 correct! Proceeding to next stage.`);
      window.location.href='Impostor 1.5.html';
    }else{
      alert(`You got ${correctCount}/12 correct. At least 70% needed.`);
    }
  }

  document.getElementById('submitBtn').addEventListener('click',checkAll);
  renderGrid();
</script>
</body>
</html>
